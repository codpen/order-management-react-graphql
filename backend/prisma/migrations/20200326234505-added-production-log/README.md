# Migration `20200326234505-added-production-log`

This migration has been generated by Rostislav Klein at 3/26/2020, 11:45:05 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."ProductionLog" (
    "action" text  NOT NULL DEFAULT '',
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "createdBy" text  NOT NULL ,
    "id" text  NOT NULL ,
    "orderItem" text  NOT NULL ,
    "pieces" integer  NOT NULL DEFAULT 0,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."Address" DROP CONSTRAINT IF EXiSTS "Address_createdBy_fkey";

ALTER TABLE "public"."Customer" DROP CONSTRAINT IF EXiSTS "Customer_createdBy_fkey";

ALTER TABLE "public"."Material" DROP CONSTRAINT IF EXiSTS "Material_createdBy_fkey";

ALTER TABLE "public"."Order" DROP CONSTRAINT IF EXiSTS "Order_createdBy_fkey";

ALTER TABLE "public"."OrderItem" DROP CONSTRAINT IF EXiSTS "OrderItem_createdBy_fkey";

ALTER TABLE "public"."ProductionLog" ADD FOREIGN KEY ("createdBy")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."ProductionLog" ADD FOREIGN KEY ("orderItem")REFERENCES "public"."OrderItem"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Address" ADD FOREIGN KEY ("createdBy")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Customer" ADD FOREIGN KEY ("createdBy")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Material" ADD FOREIGN KEY ("createdBy")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Order" ADD FOREIGN KEY ("createdBy")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."OrderItem" ADD FOREIGN KEY ("createdBy")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200321221753-customer-speial-price..20200326234505-added-production-log
--- datamodel.dml
+++ datamodel.dml
@@ -6,14 +6,14 @@
 // The `url` field must contain the connection string to your DB.
 // Learn more about connection strings for your DB: https://pris.ly/connection-strings
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 // Other examples for connection strings are:
-// SQLite: url = "***"
-// MySQL:  url = "***"
+// SQLite: url = "sqlite:./dev.db"
+// MySQL:  url = "mysql://johndoe:johndoe@localhost:3306/mydb"
 // You can also use environment variables to specify the connection string: https://pris.ly/prisma-schema#using-environment-variables
 // By adding the `generator` block, you specify that you want to generate Prisma's DB client.
 // The client is generated by runnning the `prisma generate` command and will be located in `node_modules/@prisma` and can be imported in your code as:
@@ -75,8 +75,17 @@
   updatedAt  DateTime  @updatedAt
   createdBy  User
 }
+model ProductionLog {
+  id         String    @id @default(cuid())
+  orderItem  OrderItem
+  action     String
+  pieces     Int
+  createdAt  DateTime  @default(now())
+  createdBy  User
+}
+
 model Customer {
   id                      String    @id @default(cuid())
   name                    String?
   personName              String?
```


